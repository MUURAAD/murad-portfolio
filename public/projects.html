<!DOCTYPE html>
<html lang="en" data-theme="light" data-accent="green">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Projects - Murad</title> <!-- Updated Title -->

  <!-- Bootstrap + Icons + Fonts -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">

  <style>
    /* ----------------- THEME & ACCENT VARIABLES (Consistent) ----------------- */
    :root{
      --bg: #f4f7fb; --card-bg: #ffffff; --muted: #596a75;
      --primary: #20c997; --primary-700:#179b77;
      --glass: rgba(255,255,255,0.6); --shadow: 0 10px 30px rgba(16,24,40,0.08);
      --radius: 14px; --accent-shadow: 0 12px 30px rgba(32,201,151,0.14);
      --nav-height: 64px; --max-content-width: 1180px;
      --profile-grad-from: var(--primary); --profile-grad-to: var(--primary-700);
    }

    [data-theme="dark"]{
      --bg: #0b1220; --card-bg: #0f1b28; --muted: #b6cad6;
      --primary: #43d9b2; --primary-700:#2fbf9a;
      --glass: rgba(255,255,255,0.03); --shadow: 0 12px 40px rgba(0,0,0,0.7);
      --accent-shadow: 0 12px 30px rgba(67,217,178,0.08);
    }

    [data-accent="green"] { --primary: #20c997; --primary-700: #179b77; --accent-shadow: 0 12px 30px rgba(32,201,151,0.14); }
    [data-accent="yellow"] { --primary: #f1c40f; --primary-700: #d4a70b; --accent-shadow: 0 12px 30px rgba(241,196,15,0.12); }
    [data-accent="red"] { --primary: #e74c3c; --primary-700: #c0382b; --accent-shadow: 0 12px 30px rgba(231,76,60,0.12); }

    html,body{height:100%;}
    body{
      margin:0; font-family:'Comfortaa',sans-serif;
      background:var(--bg); color:var(--muted);
      transition: background .35s ease, color .35s ease;
      padding-top: var(--nav-height);
      padding-bottom: 60px; /* For mobile quote bar */
    }

    /* layout utilities */
    .container-xl{ max-width: var(--max-content-width); }
    .shadow-soft{ box-shadow: var(--shadow); }
    .glass{ background: var(--glass); border-radius: 10px; }

    /* NAVBAR (Consistent) */
    .navbar-custom{
      height: var(--nav-height);
      background: linear-gradient(90deg, rgba(0,0,0,0.04), rgba(255,255,255,0.02));
      backdrop-filter: blur(6px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }
    .logo-img {
      height: 40px; width: auto; object-fit: contain;
      border-radius: 50%; border: 2px solid var(--primary);
      transition: border-color 0.3s ease;
    }
    .logo-text{ font-weight:800; color:var(--primary-700); font-size:1.35rem; }
    .nav-link{ color:var(--muted) !important; padding:8px 14px; border-radius:8px; font-weight:600; }
    .nav-link:hover{ background: rgba(0,0,0,0.04); color:var(--primary) !important; transform: translateY(-3px); }

    .accent-palette { display:flex; gap:8px; align-items:center; }
    .accent-dot {
      width:18px; height:18px; border-radius:50%;
      cursor:pointer; border:2px solid rgba(255,255,255,0.9);
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    }
    .accent-dot[aria-checked="true"] { transform: scale(1.15); box-shadow: 0 6px 18px rgba(0,0,0,0.15); }

    @media (max-width: 991.98px) {
      .navbar-collapse.show {
        background: var(--card-bg);
        padding: 16px; border-radius: var(--radius);
        margin-top: 8px; box-shadow: var(--shadow); display: block;
      }
      .navbar-collapse.show .navbar-nav .nav-link { padding: 10px 12px; }
    }

    /* Page-specific Filter Bar Style (Consistent) */
    .filter-bar {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
    }
    .filter-bar .dropdown-menu {
      background: var(--card-bg);
      box-shadow: var(--shadow);
      border: 1px solid var(--glass);
      backdrop-filter: blur(5px);
    }
    .filter-bar .dropdown-item {
      color: var(--muted);
      background: transparent;
      cursor: pointer;
    }
    .filter-bar .dropdown-item:hover {
      background: var(--glass);
      color: var(--primary);
    }
    .filter-bar .dropdown-item input {
      margin-right: 10px;
    }
    .filter-bar .form-control {
      background: var(--glass);
      border-color: transparent;
      color: var(--muted);
    }
    .filter-bar .form-control::placeholder {
      color: var(--muted);
      opacity: 0.7;
    }
    .btn-outline-secondary {
      color: var(--muted);
      border-color: var(--glass);
    }
    .btn-outline-secondary:hover {
      background: var(--glass);
      color: var(--primary);
    }
    .btn-primary {
      background-color: var(--primary);
      border-color: var(--primary);
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      background-color: var(--primary-700);
      border-color: var(--primary-700);
    }

    /* --- V2 Blog Grid & Card Styles (Consistent) --- */
    .blog-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
    }
    .blog-card-v2 { /* Base card style */
      display: flex; flex-direction: column; background: var(--glass);
      backdrop-filter: blur(10px); border: 1px solid var(--glass);
      border-radius: var(--radius); box-shadow: var(--shadow);
      overflow: hidden; transition: all 0.3s cubic-bezier(.17,.67,.26,1.24);
    }
    .blog-card-v2:hover {
      transform: perspective(1000px) translateY(-8px) rotateX(3deg);
      box-shadow: var(--accent-shadow); border-color: var(--primary);
    }
    .blog-card-v2-image { /* Image part */
      height: 180px; position: relative; background-size: cover;
      background-position: center; overflow: hidden;
    }
    .blog-card-v2-tag { /* Tag overlay */
      position: absolute; top: 12px; left: 12px; background: var(--glass);
      backdrop-filter: blur(5px); color: var(--muted); padding: 4px 10px;
      border-radius: 50px; font-size: 0.75rem; font-weight: 700; border: 1px solid var(--glass);
    }
    .blog-card-v2-badge { /* NEW/Top badge overlay */
      position: absolute; top: 12px; right: 12px; background: var(--primary);
      color: #fff; padding: 4px 10px; border-radius: 50px;
      font-size: 0.75rem; font-weight: 700;
    }
    .blog-card-v2-new-badge { animation: pulse 1.5s infinite; }
    .blog-card-v2-top-badge { background: linear-gradient(45deg, #f1c40f, #e67e22); }
    @keyframes pulse { /* Pulse animation */
      0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(var(--primary), 0.7); }
      70% { transform: scale(1.05); box-shadow: 0 0 10px 15px rgba(var(--primary), 0); }
      100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(var(--primary), 0); }
    }
    .blog-card-v2-content { /* Content area */
      padding: 16px; display: flex; flex-direction: column; flex-grow: 1;
    }
    .blog-card-v2-meta { /* Date/Read time row */
      display: flex; justify-content: space-between; font-size: 0.8rem;
      color: var(--muted); margin-bottom: 8px;
    }
    .blog-card-v2-title { /* Title style */
      font-size: 1.15rem; color: var(--primary-700); font-weight: 700; margin-bottom: 8px;
    }
    [data-theme="dark"] .blog-card-v2-title { color: var(--primary); }
    .blog-card-v2-excerpt { /* Excerpt style */
      font-size: 0.9rem; flex-grow: 1; margin-bottom: 12px;
    }
    .blog-card-v2-footer { /* Footer with buttons */
      display: flex; justify-content: space-between; align-items: center;
      border-top: 1px solid var(--glass); padding-top: 12px;
    }
    .btn-outline-primary { /* Button style */
      border-color: var(--primary); color: var(--primary);
    }
    .btn-outline-primary:hover { background-color: var(--primary); color: #fff; }
    .like-btn { /* Like button style */
      background: none; border: none; color: var(--muted); cursor: pointer;
      display: flex; align-items: center; gap: 5px; font-size: 0.9rem;
      padding: 4px; transition: color 0.2s ease;
    }
    .like-btn:hover { color: var(--primary); }
    .like-btn .fa-heart { font-size: 1.1rem; }
    .like-btn.liked { color: var(--primary); }

    /* Skeleton V2 (Consistent) */
    .skeleton-card {
      background: var(--glass); border-radius: var(--radius); overflow: hidden; padding: 16px;
    }
    .skeleton-image { height: 164px; background: var(--glass); border-radius: 8px; margin-bottom: 12px; }
    .skeleton-line { background: var(--glass); height: 16px; border-radius: 4px; margin-bottom: 8px; }

    /* Featured Post Style (Consistent) */
    #featuredPostContainer { margin-bottom: 24px; }
    .featured-card { /* ... same styles as athletic.html ... */
        display: flex; flex-direction: column; background: var(--card-bg);
        border-radius: var(--radius); box-shadow: var(--shadow); border: 2px solid var(--primary);
        overflow: hidden; height: 300px; position: relative;
    }
    .featured-card-image { width: 100%; height: 100%; background-size: cover; background-position: center; position: absolute; top: 0; left: 0; transition: transform 0.4s ease; }
    .featured-card:hover .featured-card-image { transform: scale(1.05); }
    .featured-card-content { position: relative; z-index: 2; padding: 24px; margin-top: auto; background: linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0)); color: #fff; }
    .featured-card-content h3 { font-size: 1.8rem; font-weight: 700; color: #fff !important; margin-bottom: 8px; }
    .featured-card-content p { color: #eee; margin-bottom: 12px; }
    .featured-card-badge { position: absolute; top: 16px; left: 16px; z-index: 3; background: var(--primary); color: #fff; font-weight: 700; padding: 6px 12px; border-radius: 50px; }
    @media (min-width: 768px) {
        .featured-card { flex-direction: row; height: 300px; }
        .featured-card-image { width: 55%; height: 100%; position: relative; }
        .featured-card-content { width: 45%; margin-top: 0; background: var(--card-bg); color: var(--muted); display: flex; flex-direction: column; justify-content: center; }
        .featured-card-content h3 { color: var(--primary-700) !important; }
        .featured-card-content p { color: var(--muted); }
        [data-theme="dark"] .featured-card-content { color: var(--muted); }
        [data-theme="dark"] .featured-card-content h3 { color: var(--primary) !important; }
        [data-theme="dark"] .featured-card-content p { color: var(--muted); }
    }

    /* Tag Cloud Style (Consistent) */
    #tagCloudContainer {
      background: var(--card-bg); padding: 16px; border-radius: var(--radius);
      margin-top: -12px; margin-bottom: 24px; box-shadow: var(--shadow);
    }
    .tag-cloud { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: center; }
    .tag-cloud span { cursor: pointer; padding: 3px 8px; border-radius: 4px; transition: all 0.2s ease; color: var(--muted); }
    .tag-cloud span:hover { background: var(--primary); color: #fff; }
    .tag-cloud span.active { background: var(--primary-700); color: #fff; font-weight: 700; }

    /* --- ADAPTED: Project Spark (Gemini Card) --- */
    .project-spark-card { /* Renamed */
      background: linear-gradient(135deg, var(--primary-700), var(--primary));
      color: #fff; padding: 20px; border-radius: var(--radius); box-shadow: var(--accent-shadow);
      display: flex; flex-direction: column;
    }
    .project-spark-card h5 { color: #fff !important; font-weight: 700; margin-bottom: 12px; }
    .project-spark-card p { font-size: 0.95rem; flex-grow: 1; opacity: 0.9; }
    .project-spark-card button { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.4); color: #fff; }
    .project-spark-card button:hover { background: rgba(255,255,255,0.3); }
    .project-spark-card #projectSparkLoading { display: none; font-weight: 600; } /* Renamed ID */

    /* --- Throwback Card (Consistent) --- */
    .throwback-card { border-left: 4px solid var(--primary); }
    .throwback-card h6 { color: var(--primary-700) !important; font-size: 0.9rem; margin-bottom: 4px; }

    /* --- Special Cards for Projects (NEW/ADAPTED) --- */
    .current-focus-card { background: linear-gradient(135deg, #6c5ce7, #a29bfe); color: #fff; text-align: center; }
    .current-focus-card h5 { color: #fff !important; }
    .current-focus-card p { opacity: 0.9; margin-bottom: 8px; }
    .current-focus-card .status { font-size: 1.1rem; font-weight: 600; }

    .tech-stack-card { padding: 16px; }
    .tech-stack-card h6 { margin-bottom: 12px; color: var(--primary-700) !important; }
    .tech-stack-card .tech-list { display: flex; flex-wrap: wrap; gap: 8px; }
    .tech-stack-card .tech-item { background: var(--glass); padding: 4px 10px; border-radius: 50px; font-size: 0.8rem; font-weight: 600; }

    .collab-call-card { text-align: center; padding: 20px 16px; }
    .collab-call-card i { font-size: 2.5rem; color: var(--primary); margin-bottom: 8px; }
    .collab-call-card h6 { margin-bottom: 4px; }
    .collab-call-card p { font-size: 0.85rem; margin-bottom: 12px; }

    .resource-link-card { display: flex; align-items: center; gap: 12px; padding: 16px; }
    .resource-link-card i { font-size: 2rem; color: var(--primary); opacity: 0.8; }
    .resource-link-card h6 { font-size: 0.9rem; margin-bottom: 2px; color: var(--primary-700) !important; }
    .resource-link-card p { font-size: 0.8rem; margin-bottom: 0; }
    .resource-link-card a { font-weight: 600; color: var(--primary); }


    /* transitions (fade) */
    .page-fade-out { opacity: 0; transition: opacity .35s ease; }

    /* Floating Elements (Consistent) */
    .fab{ position:fixed; bottom:28px; right:28px; width:64px; height:64px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:var(--primary); color:#fff; box-shadow:0 20px 40px rgba(0,0,0,0.18); cursor:pointer; z-index: 999; }
     @media(max-width: 768px) { .fab { bottom: 80px; } }
    footer { background: transparent; color: var(--muted); padding: 40px 15px; margin-top: 60px; }
    footer h5 { color: var(--primary); }
    footer .form-control { background: var(--card-bg); border-color: var(--glass); color: var(--muted); }
    footer .form-control::placeholder { color: var(--muted); opacity: 0.7; }
    #toastNotification { /* ... same styles ... */
        position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%); background: var(--primary-700);
        color: #fff; padding: 14px 22px; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        transition: bottom 0.5s cubic-bezier(.17,.67,.26,1.24); z-index: 1000; font-weight: 600;
    }
    #toastNotification.show { bottom: 20px; }
    #toastNotification.error { background: #e74c3c; }
    .share-btn { /* ... same styles ... */
        background: none; border: none; color: var(--muted); cursor: pointer; padding: 4px; border-radius: 50%;
        display: flex; align-items: center; justify-content: center; width: 30px; height: 30px; transition: all 0.2s ease;
    }
    .share-btn:hover { color: var(--primary); background: var(--glass); }
    #quoteCard { /* ... same styles ... */
        position: fixed; bottom: 20px; right: 20px; max-width: 280px; background: var(--glass);
        backdrop-filter: blur(8px); border-radius: var(--radius); padding: 16px; box-shadow: var(--shadow);
        z-index: 998; transition: all 0.4s ease; opacity: 0.95;
    }
    #quoteCard p { margin-bottom: 0.25rem; font-size: 0.9rem; color: var(--muted); font-weight: 500; transition: opacity 0.5s ease; }
    #quoteCard small { font-size: 0.8rem; color: var(--primary); font-weight: 700; display: block; text-align: right; transition: opacity 0.5s ease; }
    @media(max-width: 768px) { /* Mobile adjustments */
        #quoteCard { left: 0; right: 0; bottom: 0; max-width: 100%; border-radius: 12px 12px 0 0; padding: 12px 16px; text-align: center; }
        #quoteCard small { text-align: center; }
        #toastNotification.show { bottom: 70px; }
    }
  </style>
</head>

<body>

  <!-- NAVBAR (Tagline Updated) -->
  <nav class="navbar navbar-expand-lg fixed-top navbar-custom">
    <div class="container-xl d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
          <img src="images/logo.png" alt="Murad Logo" class="logo-img"
               onerror="this.onerror=null; this.style.display='none'; document.getElementById('logoFallback').style.display='block';">
          <div class="logo-text" id="logoFallback" style="display:none;">Murad</div>
        </a>
        <!-- UPDATED Tagline -->
        <small class="ml-3 dev-note d-none d-md-inline">Innovation</small>
      </div>

      <div class="d-flex align-items-center">
        <!-- Accent & Theme Switchers -->
        <div class="accent-palette mr-3" role="tablist" aria-label="Accent color">
          <div class="accent-dot" data-accent="green" title="Green" style="background:#20c997" aria-checked="true"></div>
          <div class="accent-dot" data-accent="yellow" title="Yellow" style="background:#f1c40f"></div>
          <div class="accent-dot" data-accent="red" title="Red" style="background:#e74c3c"></div>
        </div>
        <div class="d-flex align-items-center mr-2">
          <i id="toggleIcon" class="fas fa-sun mr-2" style="color:var(--primary)"></i>
          <label style="display:inline-block;cursor:pointer">
            <input id="themeSwitch" type="checkbox" style="display:none" aria-label="Toggle dark mode">
            <div id="switchVisual" style="width:44px;height:24px;background:rgba(0,0,0,0.06);border-radius:14px;position:relative;">
              <div id="switchDot" style="width:18px;height:18px;border-radius:50%;background:#fff;position:absolute;left:3px;top:3px;box-shadow:0 4px 10px rgba(0,0,0,0.12);"></div>
            </div>
          </label>
        </div>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
          <span class="t-icon navbar-toggler-icon" id="hamburgerSvg"></span>
        </button>
      </div>

      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <!-- Nav Links -->
        <ul class="navbar-nav align-items-center">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="athletic.html">Athletics</a></li>
          <li class="nav-item"><a class="nav-link" href="storytelling.html">Storytelling</a></li>
          <li class="nav-item"><a class="nav-link" href="projects.html">Projects</a></li>
          <li class="nav-item"><a class="nav-link" href="achievements.html">Achievements</a></li>
          <li class="nav-item"><a class="nav-link" href="about.html">Resume</a></li>
        </ul>
      </div>
    </div>
  </nav>

   <!-- ADAPTED: Current Focus Card -->
   <section class="container-xl mt-4">
    <div class="blog-card-v2 current-focus-card"> <!-- Using card style for consistency -->
        <h5>üéØ Current Focus</h5>
        <p>Developing novel ceramic composites for improved thermal stability.</p>
        <div class="status">Phase 2: Material Synthesis</div>
    </div>
  </section>

  <!-- Featured Post Section (Consistent) -->
  <section class="container-xl mt-4" id="featuredPostContainer" style="display: none;">
    <!-- Featured Project will be injected here by JS -->
  </section>

  <!-- Filter Bar (Tags updated) -->
  <section class="container-xl mt-4">
    <div class="filter-bar d-flex flex-wrap justify-content-between align-items-center">

      <!-- Filter Controls Wrapper -->
      <div class="d-flex flex-wrap">
        <!-- Filter Dropdown - UPDATED Tags -->
        <div class="dropdown mb-2 mb-md-0 mr-2">
          <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="filterDropdownBtn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-filter mr-1"></i> Filter by Area
          </button>
          <div class="dropdown-menu" id="filterDropdownMenu" aria-labelledby="filterDropdownBtn">
            <label class="dropdown-item mb-0"><input type="checkbox" value="Research" class="filter-check"> Research</label>
            <label class="dropdown-item mb-0"><input type="checkbox" value="Materials Science" class="filter-check"> Materials Science</label>
            <label class="dropdown-item mb-0"><input type="checkbox" value="Community" class="filter-check"> Community</label>
            <label class="dropdown-item mb-0"><input type="checkbox" value="Software" class="filter-check"> Software</label>
            <label class="dropdown-item mb-0"><input type="checkbox" value="Personal" class="filter-check"> Personal</label>
            <label class="dropdown-item mb-0"><input type="checkbox" value="others" class="filter-check"> Others</label>
          </div>
        </div>

        <!-- Sort By Dropdown (Consistent) -->
        <div class="dropdown mb-2 mb-md-0">
          <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="sortDropdownBtn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-sort-amount-down mr-1"></i> <span id="sortBtnText">Sort by Recent</span>
          </button>
          <div class="dropdown-menu" id="sortDropdownMenu" aria-labelledby="sortDropdownBtn">
            <a class="dropdown-item sort-option" data-sort="date">Most Recent</a>
            <a class="dropdown-item sort-option" data-sort="likeCount">Most Liked</a>
          </div>
        </div>
      </div>

      <!-- Search Input (Consistent) -->
      <div class="input-group" style="max-width: 400px; flex: 1; min-width: 250px;">
        <input type="text" id="mainSearchInput" class="form-control" placeholder="Search projects...">
        <div class="input-group-append">
          <button class="btn btn-primary" type="button" style="padding: 0.375rem 0.75rem;"><i class="fas fa-search"></i></button>
        </div>
      </div>
    </div>
  </section>

  <!-- Tag Cloud Section (Consistent) -->
  <section class="container-xl mt-3">
    <div id="tagCloudContainer">
      <div class="tag-cloud">
        <strong class="mr-2" style="font-size: 0.9rem;">Popular Areas:</strong> <!-- Updated Text -->
        <!-- Tags will be injected here -->
      </div>
    </div>
  </section>


  <!-- Main Content Area -->
  <main class="container-xl mt-4">
    <h2 class="text-center mb-4" style="color: var(--primary-700); font-weight: 700;">
      My Projects <span id="postCount" style="font-size: 1.2rem; color: var(--muted);"></span>
    </h2>
    <div id="postsContainer" class="blog-grid" aria-live="polite">
      <!-- Skeletons/Posts/Special Cards will be rendered here -->
    </div>

    <!-- Load More Button (Consistent) -->
    <div id="loadMoreContainer" class="text-center mt-4" style="display: none;">
      <button id="loadMoreBtn" class="btn btn-primary">Load More Projects</button> <!-- Updated Text -->
    </div>

    <!-- No Results Message (Consistent) -->
    <div id="noResults" class="text-center mt-5 mb-5" style="display: none;">
      <h5 style="color: var(--muted);">No projects found matching your criteria.</h5> <!-- Updated Text -->
    </div>
  </main>


  
  <!-- Footer -->
<footer id="contact">
  <div class="container-xl">
    <div class="row">
      <!-- Left: Contact Form -->
      <div class="col-md-6">
        <h5>Contact me</h5>
        <form action="https://formspree.io/f/mwpkvrvr" method="POST" id="mainContact">
          <input class="form-control mb-2" name="name" id="cname" placeholder="Name" required>
          <input class="form-control mb-2" name="email" id="cemail" placeholder="Email" type="email" required>
          <textarea class="form-control mb-2" name="message" id="cmsg" rows="3"
            placeholder="Your message, story idea, or volunteer interest..." required></textarea>
          <button class="btn btn-primary" type="submit">Send Message</button>
        </form>
      </div>

      <!-- Right: Social Links -->
      <div class="col-md-6 text-right d-none d-md-block">
        <h5>Connect Socially</h5>
        <div style="font-size:1.2rem; gap:10px; display:inline-flex; align-items:center;">
          <a href="https://www.facebook.com/murad4231" target="_blank" class="text-decoration-none text-muted">
            <i class="bi bi-facebook"></i>
          </a>
          <a href="https://www.linkedin.com/in/muradhossain42" target="_blank" class="text-decoration-none text-muted">
            <i class="bi bi-linkedin"></i>
          </a>
          <a href="mailto:muradcu42@gmail.com" class="text-decoration-none text-muted">
            <i class="bi bi-envelope"></i>
          </a>
        </div>
        <p class="mt-3 dev-note">Address: Lakshmipur, Bangladesh</p>
        <p class="mt-2 dev-note">#TrihardMurad</p>
      </div>
    </div>

    <!-- Footer bottom -->
    <div class="text-center mt-4 dev-note">
      <a href="admin.html" style="text-decoration: none; color: inherit;" title="Admin Section">&copy; 2025</a>
      Murad Hossain ‚Äî Built with Passion an love.
    </div>
  </div>
</footer>


  <!-- FLOATING ELEMENTS (Consistent, quotes updated) -->
  <div id="quoteCard">
    <p id="quoteText">Loading quote...</p>
    <small id="quoteAuthor"></small>
  </div>
  <div id="toastNotification"></div>
  <div class="fab" id="scrollTopFab" title="Scroll to top" style="display: none; transition: opacity 0.3s ease;">
    <i class="fas fa-arrow-up"></i>
  </div>

  <!-- Firebase + App Logic -->
  <script type="module">
    // Firebase (ES modules)
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
    import {
      getFirestore, collection, getDocs, addDoc, query, orderBy, limit,
      doc, updateDoc, increment, getDoc, startAfter
    } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

    // Firebase config (Consistent)
    const firebaseConfig = { /* ... same config ... */
      apiKey: "AIzaSyBnDhuKL60HNcX40JI9zQ6YIZDr1hbMZHc", authDomain: "trihardmurad.firebaseapp.com", projectId: "trihardmurad", storageBucket: "trihardmurad.appspot.com", messagingSenderId: "146538214416", appId: "1:146538214416:web:0d7ad5834eb432c385c695", measurementId: "G-GQNJV0VQQQ"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- Global State ---
    let allPosts = [];
    let topPostId = null;
    let currentSortBy = 'date';
    let renderedPostCount = 0;
    const POSTS_PER_PAGE = 9;

    // DOM Elements
    const postsContainer = document.getElementById('postsContainer');
    const noResultsEl = document.getElementById('noResults');
    const loadMoreContainer = document.getElementById('loadMoreContainer');
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    const sortBtnText = document.getElementById('sortBtnText');
    const featuredPostContainer = document.getElementById('featuredPostContainer');
    const tagCloudContainer = document.querySelector('#tagCloudContainer .tag-cloud');
    const postCountSpan = document.getElementById('postCount');
    const mainSearchInput = document.getElementById('mainSearchInput');
    const filterCheckboxes = document.querySelectorAll('.filter-check');

    // --- NEW: Static Content for Repeating Cards (Projects Version) ---
    const techStacks = [ "Python", "Firebase", "JavaScript", "React", "Ceramic Processing", "Material Characterization", "Data Analysis" ];
    const projectIdeas = [ // Examples for Gemini fallback
        "Develop a tool to predict material properties based on composition.",
        "Create a simple web app for tracking lab experiments.",
        "Build a community platform for local researchers.",
        "Design a system for monitoring environmental factors affecting material degradation."
    ];
    const resourceLinks = [
        { name: "arXiv", url: "https://arxiv.org/", description: "Preprint server for scientific papers." },
        { name: "Google Scholar", url: "https://scholar.google.com/", description: "Broad search engine for scholarly literature." },
        { name: "MDN Web Docs", url: "https://developer.mozilla.org/", description: "Resources for web developers." },
        { name: "Materials Project", url: "https://materialsproject.org/", description: "Open database of computed material properties." }
    ];
    let techIndex = 0;
    let resourceIndex = 0;
    // Indices for throwback and Gemini card remain

    // map collection => page prefix (Consistent)
    const COLLECTION_MAP = { /* ... same map ... */
        athleticPosts: 'athletic', storytellingPosts: 'storytelling', projectsPosts: 'projects', achievementsPosts: 'achievements'
    };

    // --- Skeleton Loader (Consistent) ---
    function renderSkeletons(count) { /* ... same code ... */
        postsContainer.innerHTML = ''; noResultsEl.style.display = 'none';
        for (let i = 0; i < count; i++) {
            const sk = document.createElement('div'); sk.className = 'blog-card-v2 skeleton-card';
            sk.innerHTML = `<div class="skeleton-image"></div><div class="blog-card-v2-content"><div class="skeleton-line" style="width: 60%;"></div><div class="skeleton-line" style="width: 90%;"></div><div class="skeleton-line" style="width: 100%; height: 40px; margin-top: 10px;"></div><div class="blog-card-v2-footer" style="border: none; padding-top: 10px;"><div class="skeleton-line" style="width: 50px; height: 30px;"></div><div class="skeleton-line" style="width: 100px; height: 30px;"></div></div></div>`;
            postsContainer.appendChild(sk);
        }
    }

    // --- Fetch Helper (Fetches all projects posts) ---
    async function fetchAllPosts() {
      try {
        const q = query(collection(db, "projectsPosts")); // UPDATED Collection
        const snap = await getDocs(q);
        return snap.docs.map(d => ({ id: d.id, source: "projectsPosts", sourcePage: 'projects', ...d.data() })); // UPDATED source/page
      } catch (err) {
        console.error('fetchAllPosts (Projects)', err);
        return [];
      }
    }

    // --- Render Posts (Appends posts to container) ---
    function renderPosts(postsToRender) {
      const likedPosts = JSON.parse(localStorage.getItem('projectsLikes')) || {}; // UPDATED storage key

      postsToRender.forEach((post, index) => {
        const title = post.title || 'Untitled Project'; // Updated default
        const excerpt = (post.content || 'No description...').replace(/<[^>]*>/g, '').slice(0, 100);
        const image = post.imageUrl || 'https://placehold.co/800x400/eee/aaa?text=Project+Image'; // Updated placeholder
        const dateStr = post.date ? new Date(post.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : '';
        const pagePrefix = post.sourcePage || 'projects'; // UPDATED default prefix
        const fullpostUrl = `${pagePrefix}-fullpost.html?id=${encodeURIComponent(post.id)}`; // UPDATED URL base
        const tag = post.tag || 'Others';
        const likeCount = post.likeCount || 0;
        const postDate = new Date(post.date);
        const sevenDaysAgo = new Date(); sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
        const isNew = postDate > sevenDaysAgo;
        let badgeHTML = '';
        if (post.id === topPostId) { badgeHTML = `<span class="blog-card-v2-badge blog-card-v2-top-badge">üèÜ Top Project</span>`; } // Updated text
        else if (isNew) { badgeHTML = `<span class="blog-card-v2-badge blog-card-v2-new-badge">NEW</span>`; }
        const wpm = 225; // Keep for consistency, though less relevant for projects
        const wordCount = (post.content || '').replace(/<[^>]*>/g, ' ').split(/\s+/).length;
        const readTime = Math.ceil(wordCount / wpm);
        const readTimeText = `${readTime} min read`; // Can be replaced later if needed
        const isLiked = likedPosts[post.id];
        const heartIcon = isLiked ? 'fas' : 'far';

        const article = document.createElement('article');
        article.className = 'blog-card-v2';
        article.innerHTML = `
          <div class="blog-card-v2-image" style="background-image: url('${image}');" onerror="this.style.backgroundImage='url(https://placehold.co/800x400/eee/aaa?text=Image+Error)'">
            <span class="blog-card-v2-tag">#${tag}</span> ${badgeHTML}
          </div>
          <div class="blog-card-v2-content">
            <div class="blog-card-v2-meta"><span>${dateStr}</span> <span><i class="fas fa-clock" style="opacity: 0.7; margin-right: 4px;"></i>${readTimeText}</span></div>
            <h6 class="blog-card-v2-title">${title}</h6> <p class="blog-card-v2-excerpt">${excerpt}...</p>
            <div class="blog-card-v2-footer">
              <button class="like-btn ${isLiked ? 'liked' : ''}" data-id="${post.id}"><i class="${heartIcon} fa-heart"></i> <span class="like-count">${likeCount}</span></button>
              <div class="d-flex align-items-center">
                <button class="share-btn" data-url="${fullpostUrl}" data-title="${title.replace(/"/g, '&quot;')}" data-text="${excerpt.replace(/"/g, '&quot;')}..." title="Share project"><i class="fas fa-share-alt"></i></button> <!-- Updated title -->
                <a class="btn btn-sm btn-outline-primary" href="${fullpostUrl}" style="margin-left: 8px;">View Details...</a> <!-- Updated text -->
              </div>
            </div>
          </div>`;
        postsContainer.appendChild(article);

        // --- Inject Special Cards Periodically ---
        const totalRenderedIndex = renderedPostCount + index + 1;
        if (totalRenderedIndex % 3 === 0) renderSpecificSpecialCard('tech', totalRenderedIndex);
        if (totalRenderedIndex % 5 === 0) renderSpecificSpecialCard('collab', totalRenderedIndex);
        if (totalRenderedIndex % 7 === 0) renderSpecificSpecialCard('resource', totalRenderedIndex);

      });
    }

    // --- Render Featured Post (Consistent) ---
    function renderFeaturedPost(post) {
       if (!post) { featuredPostContainer.style.display = 'none'; return; }
       featuredPostContainer.style.display = 'block';
       const title = post.title || 'Untitled Project'; const excerpt = (post.content || 'No description...').replace(/<[^>]*>/g, '').slice(0, 120); const image = post.imageUrl || 'https://placehold.co/1200x600/eee/aaa?text=Featured+Project'; const fullpostUrl = `projects-fullpost.html?id=${encodeURIComponent(post.id)}`; // CORRECTED URL
       featuredPostContainer.innerHTML = `<div class="featured-card"><span class="featured-card-badge">üöÄ Featured Project</span><div class="featured-card-image" style="background-image: url('${image}');"></div><div class="featured-card-content"><h3>${title}</h3><p>${excerpt}...</p><a class="btn btn-primary" href="${fullpostUrl}">View Details...</a></div></div>`;
    }

    // --- Render Tag Cloud (Consistent) ---
    function renderTagCloud(posts) {
        const tagCounts = {}; posts.forEach(p => { const t = p.tag || 'Others'; tagCounts[t] = (tagCounts[t] || 0) + 1; });
        const sortedTags = Object.entries(tagCounts).sort(([, a], [, b]) => b - a); const maxC = sortedTags.length > 0 ? sortedTags[0][1] : 1; const minC = sortedTags.length > 0 ? sortedTags[sortedTags.length - 1][1] : 1;
        tagCloudContainer.innerHTML = '<strong class="mr-2" style="font-size: 0.9rem;">Popular Areas:</strong>'; // Updated text
        sortedTags.slice(0, 10).forEach(([tag, count]) => {
            const el = document.createElement('span'); const minFS = 0.8, maxFS = 1.3; let fs = minFS;
            if (maxC > minC) { fs = minFS + (maxFS - minFS) * ((count - minC) / (maxC - minC)); } else if (maxC === minC && maxC > 0) { fs = (minFS + maxFS) / 2; }
            el.style.fontSize = `${fs}rem`; el.textContent = tag; el.dataset.tag = tag;
            const cb = document.querySelector(`.filter-check[value="${tag}"]`); if (cb?.checked) { el.classList.add('active'); }
            tagCloudContainer.appendChild(el);
        });
    }

    // --- ADAPTED: Render Project Spark Corner ---
    function renderProjectSparkCorner() {
      if (document.getElementById('projectSparkCard')) return; // Check if exists
      const card = document.createElement('div');
      card.id = 'projectSparkCard'; // UPDATED ID
      card.className = 'project-spark-card blog-card-v2'; // UPDATED Class
      card.innerHTML = `
        <h5>üí° Project Spark</h5>
        <p id="projectSparkContent">Loading a project idea or tip...</p>
        <div id="projectSparkLoading">Loading...</div>
        <button id="getProjectSparkBtn" class="btn btn-sm">Get New Spark</button>
      `;
      // Inject (adjust position if needed)
      if (postsContainer.children.length > 2) { postsContainer.insertBefore(card, postsContainer.children[2]); }
      else { postsContainer.appendChild(card); }
      const btn = document.getElementById('getProjectSparkBtn');
      btn.addEventListener('click', handleGetProjectSpark);
      handleGetProjectSpark(); // Load one on init
    }

    // --- Render Specific Special Card (Projects Version) ---
    function renderSpecificSpecialCard(type, position) {
        let card = document.createElement('div');
        card.className = 'blog-card-v2';
        let uniqueContent;

        switch(type) {
            case 'tech':
                const currentTech = techStacks.slice(techIndex % techStacks.length, (techIndex % techStacks.length) + 3); // Show 3 techs
                card.classList.add('tech-stack-card');
                card.innerHTML = `<h6><i class="fas fa-cogs mr-1"></i> Tech Spotlight</h6><div class="tech-list">${currentTech.map(t => `<span class="tech-item">${t}</span>`).join('')}</div>`;
                techIndex += 3; // Advance index
                break;
            case 'collab':
                card.classList.add('collab-call-card');
                card.innerHTML = `<i class="fas fa-users"></i><h6>Collaboration</h6><p>Interested in collaborating on materials science or web projects? Reach out!</p><a href="mailto:muradcu42@gmail.com" class="btn btn-sm btn-outline-primary">Contact Me</a>`;
                break;
            case 'resource':
                 uniqueContent = resourceLinks[resourceIndex % resourceLinks.length];
                card.classList.add('resource-link-card');
                card.innerHTML = `<i class="fas fa-link"></i><div><h6>Useful Resource</h6><p>${uniqueContent.description}</p><a href="${uniqueContent.url}" target="_blank">${uniqueContent.name} <i class="fas fa-external-link-alt fa-xs"></i></a></div>`;
                resourceIndex++;
                break;
            // Removed 'word', 'device', 'quote' cases
            default: return;
        }

        // Insertion logic (same as before)
        if (postsContainer.children.length >= position) { postsContainer.insertBefore(card, postsContainer.children[position -1]); }
        else { postsContainer.appendChild(card); }
    }

    // --- Page Load Logic (UPDATED Collection) ---
    async function loadProjectsPage() {
      renderSkeletons(POSTS_PER_PAGE);
      try {
        allPosts = await fetchAllPosts(); // Fetches from projectsPosts now

        if (allPosts.length > 0) {
          const topPost = [...allPosts].sort((a,b) => (b.likeCount || 0) - (a.likeCount || 0))[0];
          topPostId = topPost?.id;
          renderFeaturedPost(topPost);
          renderTagCloud(allPosts);
          postCountSpan.textContent = `(${allPosts.length} Projects)`; // Updated text
        } else {
          featuredPostContainer.style.display = 'none';
          postCountSpan.textContent = '(0 Projects)'; // Updated text
        }
        sortAndRender();
      } catch (err) {
        console.error('Failed to load projects:', err);
        postsContainer.innerHTML = '<h5 class="text-center" style="color: var(--primary);">Could not load projects. Please try again later.</h5>'; // Updated text
      }
      updateProfileGradient();
    }

    // --- Sort and Render (UPDATED special card function) ---
    function sortAndRender() {
      allPosts.sort((a, b) => { /* ... same sort logic ... */
          if (currentSortBy === 'likeCount') return (b.likeCount || 0) - (a.likeCount || 0); return new Date(b.date) - new Date(a.date);
      });
      postsContainer.innerHTML = ''; renderedPostCount = 0;
      techIndex = 0; resourceIndex = 0; // Reset special card indices
      noResultsEl.style.display = 'none';

      const initialPosts = allPosts.slice(0, POSTS_PER_PAGE);
      renderPosts(initialPosts); // Injects special cards
      renderedPostCount = initialPosts.length;

      renderProjectSparkCorner(); // Render Gemini card

      // Show/hide Load More
      if (allPosts.length > renderedPostCount) { loadMoreContainer.style.display = 'block'; }
      else { loadMoreContainer.style.display = 'none'; }
      if (postsContainer.children.length === 0 && allPosts.length === 0) { noResultsEl.style.display = 'block'; }
    }

    // --- Load More Logic (Consistent Text Update) ---
    function handleLoadMore() {
        loadMoreBtn.disabled = true; loadMoreBtn.textContent = 'Loading...';
        const actualPostsInDom = postsContainer.querySelectorAll('.blog-card-v2:not(.tech-stack-card):not(.collab-call-card):not(.resource-link-card):not(.project-spark-card)').length; // Update classes
        const nextPostIndex = actualPostsInDom;
        const newPostsToLoad = allPosts.slice(nextPostIndex, nextPostIndex + POSTS_PER_PAGE);

        renderPosts(newPostsToLoad);
        renderedPostCount += newPostsToLoad.length;

        loadMoreBtn.disabled = false; loadMoreBtn.textContent = 'Load More Projects'; // Updated text
        if (renderedPostCount >= allPosts.length) { loadMoreContainer.style.display = 'none'; }
    }
    loadMoreBtn.addEventListener('click', handleLoadMore);

    // --- Filter & Search Logic (Consistent) ---
    function filterAndRender() { /* ... same code ... */
        const text = mainSearchInput.value.toLowerCase().trim(); const tags = Array.from(filterCheckboxes).filter(i=>i.checked).map(i=>i.value.toLowerCase());
        if(text===''&&tags.length===0){ featuredPostContainer.style.display='block'; sortAndRender(); renderTagCloud(allPosts); return; }
        featuredPostContainer.style.display='none'; loadMoreContainer.style.display='none';
        let filtered = allPosts.filter(p=>{ const title=(p.title||'').toLowerCase(); const content=(p.content||'').toLowerCase(); const tag=(p.tag||'others').toLowerCase(); const matchSearch=title.includes(text)||content.includes(text); const matchTag=tags.length===0||tags.includes(tag); return matchSearch&&matchTag; });
        filtered.sort((a,b)=>{ if(currentSortBy==='likeCount') return (b.likeCount||0)-(a.likeCount||0); return new Date(b.date)-new Date(a.date); });
        postsContainer.innerHTML=''; if(filtered.length===0){ noResultsEl.style.display='block'; } else { noResultsEl.style.display='none'; renderedPostCount=0; renderPosts(filtered); renderedPostCount=filtered.length; } renderTagCloud(allPosts);
    }

    // --- Tag Cloud Click Logic (Consistent) ---
    tagCloudContainer.addEventListener('click', (e) => { /* ... same code ... */
        const chip = e.target.closest('span[data-tag]'); if (!chip) return; const tag = chip.dataset.tag; const cb = document.querySelector(`.filter-check[value="${tag}"]`); if(cb){ filterCheckboxes.forEach(c=>{if(c!==cb)c.checked=false;}); cb.checked=!chip.classList.contains('active'); filterAndRender(); document.querySelectorAll('.tag-cloud span').forEach(c=>c.classList.remove('active')); if(cb.checked) chip.classList.add('active'); }
    });

    // --- Sort By Logic (Consistent) ---
    document.querySelectorAll('.sort-option').forEach(option => { /* ... same code ... */
        option.addEventListener('click',(e)=>{ e.preventDefault(); currentSortBy=e.target.dataset.sort; sortBtnText.textContent=e.target.textContent; filterAndRender(); });
    });

    // --- Like Button Logic (UPDATED storage key) ---
    const likedPostsStore = { key: 'projectsLikes', /* ... same functions ... */
        getAll: () => JSON.parse(localStorage.getItem(likedPostsStore.key)) || {}, has: (id) => !!likedPostsStore.getAll()[id], add: (id) => { let l=likedPostsStore.getAll(); l[id]=true; localStorage.setItem(likedPostsStore.key, JSON.stringify(l)); }, remove: (id) => { let l=likedPostsStore.getAll(); delete l[id]; localStorage.setItem(likedPostsStore.key, JSON.stringify(l)); }
    };
    async function handleLikeClick(e) { /* ... same code, updated collection name & toast text ... */
        const btn=e.target.closest('.like-btn'); if(!btn) return; const id=btn.dataset.id; if(likedPostsStore.has(id)){showToast("Already liked!"); return;}
        likedPostsStore.add(id); btn.classList.add('liked'); btn.querySelector('.fa-heart').classList.replace('far','fas'); const span=btn.querySelector('.like-count'); const count=parseInt(span.textContent,10); span.textContent=count+1; const post=allPosts.find(p=>p.id===id); if(post) post.likeCount=(post.likeCount||0)+1;
        try { const ref=doc(db,'projectsPosts', id); await updateDoc(ref,{likeCount:increment(1)}); } catch(err){ console.error("Like error:",err); likedPostsStore.remove(id); btn.classList.remove('liked'); btn.querySelector('.fa-heart').classList.replace('fas','far'); span.textContent=count; showToast("Like failed.",true); }
    }
    postsContainer.addEventListener('click', handleLikeClick);

    // --- Gemini API Logic for Project Spark (Prompt Updated) ---
    const geminiApiKey = ""; const geminiApiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${geminiApiKey}`; const geminiSystemPrompt = "You are an innovation assistant. Provide a concise, interesting project idea or a useful technical tip related to materials science, research, software, or community building. Keep it to 1-2 sentences. Be encouraging. Do not use greetings or markdown."; // UPDATED Prompt
    async function fetchWithRetry(url, options, retries = 3, delay = 1000) { /* ... same code ... */
        for(let i=0;i<retries;i++){ try { const r = await fetch(url,options); if(r.ok) return r.json(); if(r.status >= 400 && r.status < 500) throw new Error(`Client error: ${r.status}`); } catch(e){} await new Promise(res => setTimeout(res, delay)); delay*=2; } throw new Error('API fetch failed.');
    }
    async function callGeminiApi(userPrompt) { /* ... same code, uses updated system prompt ... */
        const payload = { contents: [{ parts: [{ text: userPrompt }] }], systemInstruction: { parts: [{ text: geminiSystemPrompt }] }, }; const opts = { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }; const res = await fetchWithRetry(geminiApiUrl, opts); const cand = res.candidates?.[0]; if (cand?.content?.parts?.[0]?.text) { return cand.content.parts[0].text; } else { throw new Error('Invalid API response.'); }
    }
    async function handleGetProjectSpark() { // Renamed function
      const contentEl = document.getElementById('projectSparkContent'); // UPDATED ID
      const loadingEl = document.getElementById('projectSparkLoading'); // UPDATED ID
      const btnEl = document.getElementById('getProjectSparkBtn'); // UPDATED ID
      if (!contentEl || !loadingEl || !btnEl) return;
      btnEl.disabled = true; loadingEl.style.display = 'block'; contentEl.style.display = 'none';
      try { const spark = await callGeminiApi("Give me a new project idea or technical tip."); contentEl.textContent = spark.trim(); } // UPDATED User query
      catch (err) { contentEl.textContent = projectIdeas[Math.floor(Math.random() * projectIdeas.length)]; } // Use static fallback
      finally { btnEl.disabled = false; loadingEl.style.display = 'none'; contentEl.style.display = 'block'; }
    }

    // --- THEME & ACCENT LOGIC (Consistent) ---
    // ... (All theme/accent functions remain identical) ...
    const accentDots = document.querySelectorAll('.accent-dot');
    function setAccent(key){ document.documentElement.setAttribute('data-accent', key); localStorage.setItem('site-accent', key); updateProfileGradient(); accentDots.forEach(d=>d.setAttribute('aria-checked', d.dataset.accent === key)); drawHamburger(); const logo=document.querySelector('.logo-img'); if(logo) logo.style.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--primary').trim(); }
    function updateProfileGradient(){ const comp=getComputedStyle(document.documentElement); const p=comp.getPropertyValue('--primary').trim(); const p2=comp.getPropertyValue('--primary-700').trim(); document.documentElement.style.setProperty('--profile-grad-from', p || 'var(--primary)'); document.documentElement.style.setProperty('--profile-grad-to', p2 || 'var(--primary-700)'); }
    accentDots.forEach(dot=>dot.addEventListener('click',()=>setAccent(dot.dataset.accent))); const themeSwitch=document.getElementById('themeSwitch'); const switchVisual=document.getElementById('switchVisual'); const switchDot=document.getElementById('switchDot'); const toggleIcon=document.getElementById('toggleIcon');
    function setTheme(t){ document.documentElement.setAttribute('data-theme', t); localStorage.setItem('site-theme', t); if(t === 'dark'){ switchDot.style.left='23px'; toggleIcon.className='fas fa-moon mr-2'; } else { switchDot.style.left='3px'; toggleIcon.className='fas fa-sun mr-2'; }}
    const storedTheme=localStorage.getItem('site-theme')||'light'; setTheme(storedTheme); const storedAccent=localStorage.getItem('site-accent')||'green'; setAccent(storedAccent); switchVisual.addEventListener('click',()=>setTheme(document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark'));
    function drawHamburger(){ const accent=getComputedStyle(document.documentElement).getPropertyValue('--primary').trim()||'#20c997'; const svg=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath stroke='${encodeURIComponent(accent)}' stroke-width='2' d='M3 6h18M3 12h18M3 18h18' stroke-linecap='round'/%3E%3C/svg%3E`; const el=document.getElementById('hamburgerSvg'); if(el){ el.style.backgroundImage=`url("${svg}")`; el.style.backgroundSize='20px 20px'; }} drawHamburger(); window.addEventListener('resize', drawHamburger);

    // --- TOAST NOTIFICATION (Consistent) ---
    const toastEl = document.getElementById('toastNotification'); let toastTimeout; function showToast(msg, isError=false){ /* ... same ... */ clearTimeout(toastTimeout); toastEl.textContent=msg; isError?toastEl.classList.add('error'):toastEl.classList.remove('error'); toastEl.classList.add('show'); toastTimeout=setTimeout(()=>toastEl.classList.remove('show'),3000); }

    // --- UNIFIED SHARE (Consistent) ---
    document.addEventListener('click', async(e)=>{ /* ... same ... */ const btn=e.target.closest('.share-btn'); if(!btn) return; const url=location.origin+'/'+btn.dataset.url; const title=btn.dataset.title; const text=btn.dataset.text; if(navigator.share){ try{await navigator.share({title,text,url});}catch(e){} } else { try{const ta=document.createElement('textarea'); ta.value=url; ta.style.position='absolute'; ta.style.left='-9999px'; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); showToast('Link copied!');}catch(e){showToast('Copy failed.',true);} } });

    // --- FOOTER CONTACT (Consistent) ---
    window.handleContact = async function(e){ /* ... same ... */ e.preventDefault(); const btn=e.target.querySelector('button'); btn.disabled=true; btn.textContent='Sending...'; try{ await addDoc(collection(db,'contacts'), { name: cname.value, email: cemail.value, message: cmsg.value, createdAt: new Date().toISOString() }); showToast('Thanks!'); e.target.reset(); } catch(err){ showToast('Send failed.',true); } finally{ btn.disabled=false; btn.textContent='Send'; } };

    // --- SCROLL-TO-TOP FAB (Consistent) ---
    const scrollTopFab = document.getElementById('scrollTopFab'); if(scrollTopFab){ /* ... same ... */ window.addEventListener('scroll',()=>{ const show=document.body.scrollTop > 100 || document.documentElement.scrollTop > 100; scrollTopFab.style.display=show?'flex':'none'; scrollTopFab.style.opacity=show?'1':'0'; }); scrollTopFab.addEventListener('click',()=>window.scrollTo({top:0, behavior:'smooth'})); }

    // --- MOTIVATIONAL QUOTE (General Quotes) ---
    const quotes = [ // Using general motivational quotes here
        { text: "The best way to predict the future is to create it.", author: "Peter Drucker" },
        { text: "Innovation distinguishes between a leader and a follower.", author: "Steve Jobs" },
        { text: "Strive not to be a success, but rather to be of value.", author: "Albert Einstein" },
        { text: "The only source of knowledge is experience.", author: "Albert Einstein" },
        { text: "The mind is not a vessel to be filled, but a fire to be kindled.", author: "Plutarch" }
    ];
    const quoteTextEl = document.getElementById('quoteText'); const quoteAuthorEl = document.getElementById('quoteAuthor'); let quoteIndex = 0; function updateQuote(){ /* ... same logic ... */ if(!quoteTextEl||!quoteAuthorEl) return; quoteTextEl.style.opacity='0'; quoteAuthorEl.style.opacity='0'; setTimeout(()=>{let i=quoteIndex; while(i===quoteIndex) i=Math.floor(Math.random()*quotes.length); quoteIndex=i; quoteTextEl.textContent=`"${quotes[quoteIndex].text}"`; quoteAuthorEl.textContent=`‚Äî ${quotes[quoteIndex].author}`; quoteTextEl.style.opacity='1'; quoteAuthorEl.style.opacity='1';}, 500); } updateQuote(); setInterval(updateQuote, 8000);

    // --- PAGE TRANSITIONS (Consistent) ---
    document.querySelectorAll('a.nav-link, a[href$=".html"]').forEach(a=>{ /* ... same logic ... */ a.addEventListener('click',(ev)=>{const href=a.getAttribute('href');if(!href||href.startsWith('http')||href.startsWith('mailto:')||href.startsWith('#')||a.getAttribute('target')==='_blank') return; ev.preventDefault(); document.documentElement.classList.add('page-fade-out'); setTimeout(()=>location.href=href, 320); }); });

    // --- INITIALIZE PAGE ---
    (async () => {
      await loadProjectsPage(); // Call the main load function
      mainSearchInput.addEventListener('input', filterAndRender);
      filterCheckboxes.forEach(check => check.addEventListener('change', filterAndRender));
      document.getElementById('filterDropdownMenu').addEventListener('click', (e) => e.stopPropagation());
    })();

  </script>

  <!-- Bootstrap JS (Consistent) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

</body>
</html>
